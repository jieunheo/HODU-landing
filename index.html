<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>호두</title>
    <link
      rel="shortcut icon"
      href="./images/cat-subscribe.png"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="./styles/reset.css" />
    <link rel="stylesheet" href="./styles/style.css" />
    <link
      rel="stylesheet"
      href="./styles/style-desktop.css"
      media="(min-width: 1024px)"
    />
  </head>
  <body>
    <header class="header">
      <h1 class="header__logo">
        <a href="#"><img src="./images/logo.svg" alt="HODU" /></a>
      </h1>

      <button
        id="open_nav_btn"
        class="nav__btn--open"
        aria-controls="header__nav"
        aria-expanded="false"
      >
        <img src="./images/menu.svg" alt="메뉴 열기" />
      </button>
      <nav id="header_nav" class="header__nav" role="dialog" aria-modal="true">
        <button
          id="close_nav_btn"
          class="nav__btn--close"
          aria-label="메뉴 닫기"
        >
          <img src="./images/arrow-right.svg" alt="메뉴 닫기" />
        </button>
        <ul class="nav__list">
          <li class="nav__item"><a class="nav__link" href="#">Home</a></li>
          <li class="nav__item"><a class="nav__link" href="#">About</a></li>
          <li class="nav__item"><a class="nav__link" href="#">Support</a></li>
          <li class="nav__item">
            <button class="nav__btn--download">Download</button>
          </li>
        </ul>
      </nav>
    </header>

    <main class="content">
      <section class="intro">
        <h2 class="a11y-hidden">호두 랜딩 페이지 소개</h2>
        <div class="intro__text">
          <p class="intro__title">
            Lorem Ipsum is simply<br />
            <span class="intro__title--mobile">dummy text</span> of the printing
            and
          </p>
          <p class="intro__desc">
            Lorem Ipsum is simply dummy text of the printing and typesetting
            industry. Lorem Ipsum has been the industry's standard dummy text
            ever since the 1500s, when an unknown
          </p>
          <button class="btn intro__btn">Download</button>
        </div>
      </section>

      <section class="inform">
        <h2 class="a11y-hidden">호두 소개</h2>

        <picture>
          <source media="(max-width: 1024px)" srcset="./images/intro.png" />
          <source media="(min-width: 1025px)" srcset="./images/intro@2x.png" />
          <img
            class="inform__img"
            src="./images/intro.png"
            alt="이불 위에 옆으로 누워서 어딘가를 바라보는 고양이 호두"
          />
        </picture>
        <div class="inform__text">
          <p class="inform__title">
            Lorem Ipsum is simply dummy text of the printing and dummy text
          </p>
          <p class="inform__desc">
            Lorem Ipsum is simply dummy text of the printing and typesetting
            industry.
          </p>
        </div>
      </section>

      <section class="feature">
        <h3 class="a11y-hidden">호두의 다양한 모습</h3>
        <p class="feature__title">dummy text of the printing and dummy</p>
        <p class="feature__desc">
          Lorem Ipsum is simply <strong>dummy text</strong> of the printing and
          typesetting industry. Lorem Ipsum has been the industry's standard
          dummy text ever since the 1500s, when an unknown
        </p>

        <div class="feature__wrap">
          <ul class="feature__imgs">
            <li class="feature__item">
              <picture>
                <source
                  media="(max-width: 1024px)"
                  srcset="./images/img1.png"
                />
                <source
                  media="(min-width: 1025px)"
                  srcset="./images/img1@2x.png"
                />
                <img
                  class="feature__img"
                  src="./images/img1.png"
                  alt="캣타워 위에 누워서 어딘가를 바라보는 고양이 호두"
                />
              </picture>
            </li>
            <li class="feature__item">
              <picture>
                <source
                  media="(max-width: 1024px)"
                  srcset="./images/img2.png"
                />
                <source
                  media="(min-width: 1025px)"
                  srcset="./images/img2@2x.png"
                />
                <img
                  class="feature__img"
                  src="./images/img2.png"
                  alt="벽을 바라보는 뒷모습의 고양이 호두"
                />
              </picture>
            </li>
            <li class="feature__item">
              <picture>
                <source
                  media="(max-width: 1024px)"
                  srcset="./images/img3.png"
                />
                <source
                  media="(min-width: 1025px)"
                  srcset="./images/img3@2x.png"
                />
                <img
                  class="feature__img"
                  src="./images/img3.png"
                  alt="얌전히 앉아서 나를 바라보는 고양이 호두"
                />
              </picture>
            </li>
          </ul>
        </div>

        <div class="feature__post">
          <p class="feature__text">
            Lorem Ipsum is simply dummy text of the printing and typesetting
            industry. Lorem Ipsum has been the industry's standard dummy text
            ever since the 1500s, when an unknown Ipsum is simply dummy text of
            the printing and typesetting industry.
          </p>
          <a href="#" class="more__btn">Learn More</a>
        </div>
      </section>

      <section class="subscribe">
        <div class="subscribe__cont">
          <h3 class="subscribe__title">Subscribe to our Blog post</h3>
          <p class="subscribe__desc">
            Lorem Ipsum is simply dummy text of the printing and typesetting
            industry. Lorem Ipsum has been the industry's standard dummy text
          </p>
        </div>
        <form class="subscribe__form" action="#" id="subscribeForm">
          <div class="subscribe__input-wrap">
            <input
              class="subscribe__input"
              type="email"
              name="email"
              id="email"
              placeholder="Enter your e-mail address"
              aria-labelledby="구독할 이메일 입력"
              required
            />
          </div>
          <button type="submit" id="subscribe_btn" class="subscribe__btn">
            Subscribe
          </button>
        </form>
      </section>
    </main>

    <footer class="footer">
      <div class="footer__cont-wrap">
        <h2 class="a11y-hidden">사이트 정보</h2>
        <div class="footer__cont">
          <div class="footer__logo">
            <a href="#"><img src="./images/logo.svg" alt="HODU" /></a>
          </div>

          <h3 class="a11y-hidden">호두 sns 정보</h3>
          <ul class="sns">
            <li class="sns__item">
              <a class="sns__link" href="#"
                ><img src="./images/blog.svg" alt="블로그"
              /></a>
            </li>
            <li class="sns__item">
              <a class="sns__link" href="#"
                ><img src="./images/instagram.svg" alt="인스타그램"
              /></a>
            </li>
            <li class="sns__item">
              <a class="sns__link" href="#"
                ><img src="./images/facebook.svg" alt="페이스북"
              /></a>
            </li>
            <li class="sns__item">
              <a class="sns__link" href="#"
                ><img src="./images/youtube.svg" alt="유튜브"
              /></a>
            </li>
          </ul>
        </div>

        <h3 class="a11y-hidden">하단 네비게이션 링크</h3>
        <nav class="footer__nav">
          <ul>
            <li class="nav__item"><a class="nav__link" href="#">About</a></li>
            <li class="nav__item"><a class="nav__link" href="#">Blog</a></li>
            <li class="nav__item"><a class="nav__link" href="#">Support</a></li>
            <li class="nav__item">
              <a class="nav__link" href="#">Terms of Use</a>
            </li>
          </ul>
        </nav>
      </div>
    </footer>

    <aside class="aside">
      <a href="#" class="to-top">
        <span class="a11y-hidden">제일 상단으로</span>
      </a>
    </aside>

    <div id="modal" class="modal__wrap" role="dialog" aria-modal="true">
      <section class="modal">
        <h3 class="a11y-hidden">블로그 게시글 구독 성공</h3>
        <p class="modal__title">Thank you!</p>
        <p class="modal__desc">
          Lorem Ipsum is simply dummy text of the printing industry.
        </p>
        <button id="close_modal_btn" class="modal__btn">OK! I Love HODU</button>
      </section>
    </div>

    <script>
      // 포커스 트랩 제거 함수 저장 변수
      let removeTrap = null;
      // 포커스 트랩 기능 -chatGPT 도움
      function trapFocus(element) {
        // 메뉴 안에서 포커스 가능한 모든 요소
        const focusableEls = element.querySelectorAll("a[href], button");

        const firstFocusable = focusableEls[0]; // 첫번째 요소
        const lastFocusable = focusableEls[focusableEls.length - 1]; // 마지막 요소

        // 키보드 이벤트
        function handleKeyDown(e) {
          if (e.key === "Tab") {
            if (e.shiftKey) {
              // Shift + Tab
              // 첫번째 요소이면 제일 마지막 요소에 포커스
              if (document.activeElement === firstFocusable) {
                e.preventDefault(); // 기본 동작 막기
                lastFocusable.focus();
              }
            } else {
              // Tab
              // 마지막 요소이면 제일 첫번째 요소에 포커스
              if (document.activeElement === lastFocusable) {
                e.preventDefault();
                firstFocusable.focus();
              }
            }
          } else if (e.key === "Escape") {
            // ESC 키로 메뉴 닫기
            closeNav();
          }
        }

        // 요소에 이벤트 추가
        element.addEventListener("keydown", handleKeyDown);

        // 메뉴 닫힐 때 이벤트 제거
        return () => {
          element.removeEventListener("keydown", handleKeyDown);
        };
      }

      // 메뉴 열기 함수
      const openModal = (btn, modal) => {
        const is_nav_btn = btn.classList[0] === "nav__btn--open";
        if (is_nav_btn) modal.classList.add("open-nav"); // 메뉴 보이기
        else modal.classList.add("modal-show");

        btn.setAttribute("aria-expanded", "true"); // ARIA 상태 업데이트
        removeTrap = trapFocus(modal); // 포커스 트랩 활성화

        // 첫 포커스 이동
        const firstLink = modal.querySelector("a, button");
        firstLink.focus();
      };

      // 메뉴 닫기 함수
      const closeModal = (btn, modal) => {
        const is_nav_btn = btn.classList[0] === "nav__btn--open";
        if (is_nav_btn) modal.classList.remove("open-nav"); // 메뉴 숨기기
        else modal.classList.remove("modal-show");

        btn.setAttribute("aria-expanded", "false");
        if (removeTrap) removeTrap(); // 포커스 트랩 이벤트 제거
        btn.focus(); // 다시 열기 버튼에 포커스
      };

      // nav - querySelector 사용
      const open_nav_btn = document.querySelector("#open_nav_btn");
      const close_nav_btn = document.querySelector("#close_nav_btn");
      const header_nav = document.querySelector("#header_nav");

      // 버튼 클릭 이벤트 연결
      open_nav_btn.addEventListener("click", (event) => {
        openModal(open_nav_btn, header_nav);
      });
      close_nav_btn.addEventListener("click", (event) => {
        closeModal(open_nav_btn, header_nav);
      });

      // modal - getElementById 사용
      const subscribe_btn = document.getElementById("subscribe_btn");
      const modal = document.getElementById("modal");
      const close_modal_btn = document.getElementById("close_modal_btn");
      const form = document.getElementById("subscribeForm");
      const email = document.getElementById("email");

      form.addEventListener("submit", (event) => {
        if (!form.checkValidity()) {
          // 기본 메시지 보여주기
          return; // 여기서 그냥 종료 → 제출 안 함
        }

        // 기본 동작 막기 (전송 방지)
        event.preventDefault();

        // 여기서 원하는 동작만 실행
        openModal(subscribe_btn, modal);
      });
      close_modal_btn.addEventListener("click", (event) => {
        closeModal(subscribe_btn, modal);

        subscribe_btn.setAttribute("disabled", "true");
      });
    </script>
  </body>
</html>
